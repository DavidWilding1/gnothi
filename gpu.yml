version: "3.7"

services:
  gpu:
    build: gpu
    container_name: jgpu
    restart: unless-stopped
    environment:
      ENVIRONMENT: production
      TORCH_HOME: /bigmodels
    volumes:
      - ./gpu:/app
      - ./common:/app/common
      - ./.aws:/root/.aws
      - ./bigmodels:/bigmodels
    device_requests:
      - capabilities:
          - "gpu"
    logging:
      options:
        max-size: "5m"
        max-file: "3"
